# CORP (Crypto Options Research Platform) 环境变量配置
# 复制此文件为 .env 并填入你的 API key

# =============================================================================
# Exchange API Keys (可选 - 公共 API 无需 key 即可使用)
# =============================================================================

# Deribit API (https://www.deribit.com/account/api)
# 用于获取更高的 API 频率限制
DERIBIT_API_KEY=your_deribit_api_key_here
DERIBIT_API_SECRET=your_deribit_api_secret_here

# OKX API (https://www.okx.com/account/my-api)
# 用于获取更高的 API 频率限制
OKX_API_KEY=your_okx_api_key_here
OKX_API_SECRET=your_okx_api_secret_here
OKX_PASSPHRASE=your_okx_passphrase_here

# =============================================================================
# 交易所 API URL (可选 - 用于切换测试网/生产网)
# =============================================================================

# Deribit API URL
DERIBIT_BASE_URL=https://www.deribit.com/api/v2/public
DERIBIT_WS_URL=wss://www.deribit.com/ws/api/v2/public

# OKX API URL
OKX_BASE_URL=https://www.okx.com
OKX_WS_URL=wss://ws.okx.com:8443/ws/v5/public

# =============================================================================
# 日志配置
# =============================================================================

# 日志级别: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# 日志文件路径 (相对或绝对)
LOG_FILE=logs/corp.log

# 日志格式: json 或 standard
LOG_FORMAT=standard

# Health Server 日志级别: debug, info, warning, error
HEALTH_LOG_LEVEL=warning

# =============================================================================
# 服务端口配置 (用于 Docker 部署)
# =============================================================================

# Health Server 配置
HEALTH_HOST=0.0.0.0
HEALTH_PORT=8080

# 交易引擎服务端口
TRADING_ENGINE_PORT=8080

# 风险监控服务端口
RISK_MONITOR_PORT=8081

# 市场数据收集服务端口
MARKET_DATA_COLLECTOR_PORT=8082

# =============================================================================
# Docker Compose 端口配置
# =============================================================================

# Jupyter Lab 端口
JUPYTER_PORT=8888

# API 服务端口
API_PORT=8000

# Redis 端口
REDIS_PORT=6379

# PostgreSQL 端口
POSTGRES_PORT=5432

# Prometheus 端口 (生产环境)
PROMETHEUS_PORT=9090

# Grafana 端口 (生产环境)
GRAFANA_PORT=3000

# =============================================================================
# Docker 数据卷配置
# =============================================================================

# 数据目录
CORP_DATA_DIR=./data

# 日志目录
CORP_LOGS_DIR=./logs

# Notebooks 目录
CORP_NOTEBOOKS_DIR=./notebooks

# 环境变量文件路径
CORP_ENV_FILE=./.env

# =============================================================================
# Redis 配置
# =============================================================================

# Redis 主机地址
REDIS_HOST=localhost

# Redis 端口
REDIS_PORT=6379

# Redis 数据库编号
REDIS_DB=0

# Redis 密码 (如果没有密码请留空)
REDIS_PASSWORD=

# Redis 连接池配置
REDIS_HEALTH_CHECK_INTERVAL=30
REDIS_MAX_CONNECTIONS=50
REDIS_CONNECT_TIMEOUT=5
REDIS_SOCKET_TIMEOUT=5

# =============================================================================
# DuckDB 配置
# =============================================================================

# DuckDB 数据库文件路径 (留空使用内存模式)
DUCKDB_PATH=

# DuckDB 内存限制 (MB)
DUCKDB_MEMORY_LIMIT_MB=2048

# =============================================================================
# 数据配置
# =============================================================================

# 数据缓存目录
DATA_CACHE_DIR=data/cache

# 历史数据默认时间范围 (天数)
DEFAULT_LOOKBACK_DAYS=30

# =============================================================================
# WebSocket 配置
# =============================================================================

# 重连间隔 (秒)
WS_RECONNECT_INTERVAL=5.0

# 最大重连次数
WS_MAX_RECONNECTS=10

# Ping 间隔 (秒)
WS_PING_INTERVAL=20.0

# =============================================================================
# 金融参数配置
# =============================================================================

# 无风险利率 (年化)
RISK_FREE_RATE=0.05

# =============================================================================
# 风控配置 (熔断器)
# =============================================================================

# 日亏损限制 (%)
CB_DAILY_LOSS_LIMIT_PCT=0.10

# 日亏损警告阈值 (%)
CB_DAILY_LOSS_WARNING_PCT=0.05

# 最大回撤限制 (%)
CB_MAX_DRAWDOWN_PCT=0.15

# 回撤警告阈值 (%)
CB_DRAWDOWN_WARNING_PCT=0.08

# VaR 95% 限制 (%)
CB_VAR_95_LIMIT_PCT=0.05

# VaR 99% 限制 (%)
CB_VAR_99_LIMIT_PCT=0.10

# 持仓集中度限制 (%)
CB_POSITION_CONCENTRATION_LIMIT=0.30

# 集中度警告阈值 (%)
CB_CONCENTRATION_WARNING_PCT=0.20

# 熔断后冷却时间 (秒)
CB_COOLDOWN_SECONDS=300

# 自动恢复启用 (true/false)
CB_AUTO_RECOVERY_ENABLED=true

# 恢复检查间隔 (秒)
CB_RECOVERY_CHECK_INTERVAL=60

# 正常状态下仓位限制倍数
CB_NORMAL_POS_LIMIT_MULT=1.0

# 警告状态下仓位限制倍数
CB_WARNING_POS_LIMIT_MULT=0.5

# 限制状态下仓位限制倍数
CB_RESTRICTED_POS_LIMIT_MULT=0.1

# =============================================================================
# 做市策略配置
# =============================================================================

# 基础价差 (基点)
MM_SPREAD_BPS=20.0

# 报价数量
MM_QUOTE_SIZE=1.0

# 库存限制
MM_INVENTORY_LIMIT=10.0

# =============================================================================
# 回测引擎配置
# =============================================================================

# 基础延迟 (毫秒)
BT_BASE_LATENCY_MS=50.0

# 延迟标准差 (毫秒)
BT_LATENCY_STD_MS=20.0

# 队列位置随机化 (true/false)
BT_QUEUE_POSITION_RANDOM=true

# 逆向选择因子 (0-1)
BT_ADVERSE_SELECTION_FACTOR=0.3

# 最小盈利基点 (%)
BT_MIN_PROFIT_BPS=0.5

# 默认手续费率 (maker/taker)
DEFAULT_MAKER_FEE=0.0002
DEFAULT_TAKER_FEE=0.0005

# 滑点模型: fixed 或 proportional
SLIPPAGE_MODEL=fixed
DEFAULT_SLIPPAGE_BPS=1.0

# 币本位回测默认设置
DEFAULT_BASE_CURRENCY=BTC
INITIAL_CRYPTO_BALANCE=1.0  # 初始加密货币余额 (如 1 BTC)

# =============================================================================
# 数据库配置
# =============================================================================

# PostgreSQL 配置 (用于 docker-compose.yml)
POSTGRES_USER=corp
POSTGRES_PASSWORD=change_this_to_secure_password
POSTGRES_DB=corp_db

# 生产环境 PostgreSQL 配置
DB_USER=mm_user
DB_PASSWORD=CHANGE_ME_STRONG_PASSWORD
DB_NAME=market_making

# Grafana 配置 (用于 docker-compose.prod.yml)
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=change_this_to_secure_password

# 部署根目录 (用于生产环境 docker-compose)
DEPLOYMENT_ROOT=/opt/corp
